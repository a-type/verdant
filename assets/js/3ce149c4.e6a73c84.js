"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5799],{369:(e,n,r)=>{r.d(n,{xA:()=>c,yg:()=>f});var t=r(7378);function i(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function a(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach((function(n){i(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function s(e,n){if(null==e)return{};var r,t,i=function(e,n){if(null==e)return{};var r,t,i={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||(i[r]=e[r]);return i}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}var l=t.createContext({}),p=function(e){var n=t.useContext(l),r=n;return e&&(r="function"==typeof e?e(n):a(a({},n),e)),r},c=function(e){var n=p(e.components);return t.createElement(l.Provider,{value:n},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},y=t.forwardRef((function(e,n){var r=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=p(r),y=i,f=u["".concat(l,".").concat(y)]||u[y]||d[y]||o;return r?t.createElement(f,a(a({ref:n},c),{},{components:r})):t.createElement(f,a({ref:n},c))}));function f(e,n){var r=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var o=r.length,a=new Array(o);a[0]=y;var s={};for(var l in n)hasOwnProperty.call(n,l)&&(s[l]=n[l]);s.originalType=e,s[u]="string"==typeof e?e:i,a[1]=s;for(var p=2;p<o;p++)a[p]=r[p];return t.createElement.apply(null,a)}return t.createElement.apply(null,r)}y.displayName="MDXCreateElement"},7339:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var t=r(8084),i=(r(7378),r(369));const o={sidebar_position:4},a="Presence & Profiles",s={unversionedId:"sync/presence",id:"sync/presence",title:"Presence & Profiles",description:"Once you're syncing, presence info is available on client.sync.presence (where client is your instance of Client).",source:"@site/docs/sync/presence.md",sourceDirName:"sync",slug:"/sync/presence",permalink:"/docs/sync/presence",draft:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Connecting a Client",permalink:"/docs/sync/client"},next:{title:"Advanced: Transports",permalink:"/docs/sync/transports"}},l={},p=[{value:"Profiles",id:"profiles",level:2},{value:"Views and Fields",id:"views-and-fields",level:2},{value:"Views (experimental)",id:"views-experimental",level:3},{value:"Fields",id:"fields",level:3}],c={toc:p},u="wrapper";function d(e){let{components:n,...r}=e;return(0,i.yg)(u,(0,t.A)({},c,r,{components:n,mdxType:"MDXLayout"}),(0,i.yg)("h1",{id:"presence--profiles"},"Presence & Profiles"),(0,i.yg)("p",null,"Once you're syncing, presence info is available on ",(0,i.yg)("inlineCode",{parentName:"p"},"client.sync.presence")," (where ",(0,i.yg)("inlineCode",{parentName:"p"},"client")," is your instance of Client)."),(0,i.yg)("p",null,"You can get ",(0,i.yg)("inlineCode",{parentName:"p"},"presence.self"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"presence.peers"),", or ",(0,i.yg)("inlineCode",{parentName:"p"},"presence.everyone"),". You can also subscribe to change events: ",(0,i.yg)("inlineCode",{parentName:"p"},"peerChanged(userId, presence)"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"selfChanged(presence)"),", ",(0,i.yg)("inlineCode",{parentName:"p"},"peersChanged(peers: { [userId]: presence })"),". Note that if you did not supply user information on your server and used the example code above, all peers will show up with the same exact identity! If you want to make each peer individual, you need to give them all unique user IDs. You could generate them on your server in-memory if you don't want persistent profiles."),(0,i.yg)("p",null,'Verdant distinguishes between "replica ID" (i.e. individual device) and "user ID." The intention is to allow one actual person to use multiple devices, but only have one presence which follows them between devices.'),(0,i.yg)("p",null,"To update your presence, use ",(0,i.yg)("inlineCode",{parentName:"p"},"presence.update"),"."),(0,i.yg)("h2",{id:"profiles"},"Profiles"),(0,i.yg)("p",null,"Profiles are stored and pulled from the server. A user may not edit their own profile from Verdant. It's a good place to put data you need to trust, like user role or identity."),(0,i.yg)("p",null,"When initializing sync, you must supply a ",(0,i.yg)("inlineCode",{parentName:"p"},"defaultProfile")," value. That's because presence is available immediately, before sync can connect and retrieve user profiles, so something needs to be there. You can either type your Profile data as ",(0,i.yg)("inlineCode",{parentName:"p"},"{ /* your server data*/ } | null")," and supply ",(0,i.yg)("inlineCode",{parentName:"p"},"null"),", or supply an empty value that makes sense for your data."),(0,i.yg)("h2",{id:"views-and-fields"},"Views and Fields"),(0,i.yg)("p",null,"Verdant has some presence concepts built-in for convenience. So far, this includes ",(0,i.yg)("em",{parentName:"p"},"views")," and ",(0,i.yg)("em",{parentName:"p"},"fields"),"."),(0,i.yg)("h3",{id:"views-experimental"},"Views (experimental)"),(0,i.yg)("p",null,'A "view" is a rough concept (because not all apps are structured with pages, etc). All you need for a view is a unique ID. For React users, pass the view ID to the ',(0,i.yg)("inlineCode",{parentName:"p"},"useViewId")," hook to auto-register the user's presence in that view. The most recently rendered view with this hook will 'win,' and a user can only register one view at a time for presence. When unmounted, the hook will reset to ",(0,i.yg)("inlineCode",{parentName:"p"},"undefined"),"."),(0,i.yg)("blockquote",null,(0,i.yg)("p",{parentName:"blockquote"},"Using nested views is not recommended. I would restrict usage to top-level, exclusive 'routes' or similar concepts.")),(0,i.yg)("p",null,"Use the ",(0,i.yg)("inlineCode",{parentName:"p"},"useViewPeers")," hook to see which of your online peers are on the same view."),(0,i.yg)("h3",{id:"fields"},"Fields"),(0,i.yg)("p",null,'A "field" is similar to a "view" in that it\'s really just an ID. Fields are ',(0,i.yg)("em",{parentName:"p"},"roughly")," mapped to actual entity fields in Verdant, but you ",(0,i.yg)("em",{parentName:"p"},"could")," use this feature for anything really."),(0,i.yg)("p",null,"Like views, each replica has one registered field in presence. However, unlike views, it expires after a minute."),(0,i.yg)("p",null,"Where field presence really works best is in a tighter framework integration, like Verdant's own ",(0,i.yg)("a",{parentName:"p",href:"/docs/react#useField-hook"},"React bindings")))}d.isMDXComponent=!0}}]);