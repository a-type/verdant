"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9705],{112:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>r,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"internals/assumptions","title":"Protocol assumptions","description":"Collecting some thoughts about assumptions made in Verdant\'s sync protocols. May format this to be more readable at some point, but for now it\'s mostly for me (doubt you\'re considering implementing your own replica client).","source":"@site/docs/internals/assumptions.md","sourceDirName":"internals","slug":"/internals/assumptions","permalink":"/docs/internals/assumptions","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2},"sidebar":"tutorialSidebar","previous":{"title":"Initial sync","permalink":"/docs/internals/initial-sync"},"next":{"title":"Entity IDs","permalink":"/docs/internals/entity-ids"}}');var o=s(7557),i=s(6039);const r={sidebar_position:2},a="Protocol assumptions",c={},l=[];function d(e){const n={code:"code",h1:"h1",header:"header",p:"p",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"protocol-assumptions",children:"Protocol assumptions"})}),"\n",(0,o.jsx)(n.p,{children:"Collecting some thoughts about assumptions made in Verdant's sync protocols. May format this to be more readable at some point, but for now it's mostly for me (doubt you're considering implementing your own replica client)."}),"\n",(0,o.jsxs)(n.p,{children:["A replica always does a ",(0,o.jsx)(n.code,{children:"sync"})," exchange (",(0,o.jsx)(n.code,{children:"sync"}),", ",(0,o.jsx)(n.code,{children:"sync-resp"}),", ",(0,o.jsx)(n.code,{children:"sync-ack"}),") before sending any other messages (with the exception of ",(0,o.jsx)(n.code,{children:"presence-update"})," which may be sent in parallel)"]}),"\n",(0,o.jsxs)(n.p,{children:["Every operation which arrives to the server is guaranteed to be earlier in timestamp than any subsequently sent operations. In other words, replicas ensure operations are sent in time order, whether they be in ",(0,o.jsx)(n.code,{children:"sync"})," or ",(0,o.jsx)(n.code,{children:"op"})," messages. Hence always ",(0,o.jsx)(n.code,{children:"sync"})," before sending any ",(0,o.jsx)(n.code,{children:"op"}),"s. Internal client batching behavior must also account for this (in the client this is ensured by rewriting outgoing operation timestamps to ",(0,o.jsx)(n.code,{children:"now"})," before flushing a batch)"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},6039:(e,n,s)=>{s.d(n,{R:()=>r,x:()=>a});var t=s(8225);const o={},i=t.createContext(o);function r(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);