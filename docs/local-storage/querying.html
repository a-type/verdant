<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-local-storage/querying" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Indexes &amp; Querying | Verdant</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://verdant.dev/docs/local-storage/querying"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:title" content="verdant"><meta data-rh="true" name="twitter:description" content="a framework for small, sustainable, human apps"><meta data-rh="true" name="twitter:image" content="https://verdant.dev/opengraph.png"><meta data-rh="true" name="og:image" content="https://verdant.dev/opengraph.png"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Indexes &amp; Querying | Verdant"><meta data-rh="true" name="description" content="By default you can retrieve lists of all documents in a collection, or just one by its primary key."><meta data-rh="true" property="og:description" content="By default you can retrieve lists of all documents in a collection, or just one by its primary key."><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://verdant.dev/docs/local-storage/querying"><link data-rh="true" rel="alternate" href="https://verdant.dev/docs/local-storage/querying" hreflang="en"><link data-rh="true" rel="alternate" href="https://verdant.dev/docs/local-storage/querying" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.d68acea8.css">
<script src="/assets/js/runtime~main.5dbf2876.js" defer="defer"></script>
<script src="/assets/js/main.572f2b6c.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/favicon-32x32.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_jQYJ" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/favicon-32x32.png" alt="Verdant logo" class="themedComponent_p3Hn themedComponent--light_HsQM"><img src="/favicon-32x32.png" alt="Verdant logo" class="themedComponent_p3Hn themedComponent--dark_Gkkm"></div><b class="navbar__title text--truncate">Verdant</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/a-type/verdant" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_yf4q"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_GROg colorModeToggle_G0yw"><button class="clean-btn toggleButton_S2gv toggleButtonDisabled_CHjR" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_c37i"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_VmAt"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_QbSV"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_wEH3"><div class="docsWrapper_bjwv"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_Vyet" type="button"></button><div class="docRoot_MTNO"><aside class="theme-doc-sidebar-container docSidebarContainer_crcc"><div class="sidebarViewport__K9x"><div class="sidebar_njsd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_Q301"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Intro to Verdant</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/manifesto">The Verdant manifesto on sustainable software</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/storing--querying">Storing &amp; Querying</a><button aria-label="Collapse sidebar category &#x27;Storing &amp; Querying&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/schema">Schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/generate-client">Generating the client code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/migrations">Migrations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/local-storage/querying">Indexes &amp; Querying</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/entities">Documents &amp; Entities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/undo">Undo, Redo, and Batching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/files">File storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/export">Exporting and importing data</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/sync">Sync</a><button aria-label="Expand sidebar category &#x27;Sync&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cli">CLI</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/react-bindings">React Bindings</a><button aria-label="Expand sidebar category &#x27;React Bindings&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/integrations">Integrations</a><button aria-label="Expand sidebar category &#x27;Integrations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/how-it-works">How it works</a><button aria-label="Expand sidebar category &#x27;How it works&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/comparisons">Comparisons to other local-first tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/efficiency">Efficiency &amp; Performance</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tutorials">Tutorials</a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_c_j_"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_dTXs"><div class="docItemContainer_ZI0Z"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_XOIV" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_IXAf"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/storing--querying"><span itemprop="name">Storing &amp; Querying</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Indexes &amp; Querying</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_oeHd theme-doc-toc-mobile tocMobile_NjDA"><button type="button" class="clean-btn tocCollapsibleButton_IKR7">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Indexes &amp; Querying</h1></header>
<p>By default you can retrieve lists of all documents in a collection, or just one by its primary key.</p>
<p>To do more complex queries, you must create new indexes. Indexes are values that get re-computed from your document&#x27;s data every time it&#x27;s changed.</p>
<h2 class="anchor anchorWithStickyNavbar_IbEo" id="indexes">Indexes<a href="#indexes" class="hash-link" aria-label="Direct link to Indexes" title="Direct link to Indexes">​</a></h2>
<p><code>indexes</code> are simple indexes which are computed from the data in a document. For example, if you want to index the field <code>done</code>, you could create an index for it:</p>
<div class="language-ts codeBlockContainer_RtSA theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_TVFK"><pre tabindex="0" class="prism-code language-ts codeBlock_Y3bB thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_hR3p"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> items </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">collection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;item&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	primaryKey</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;id&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	fields</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fields</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		done</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fields</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">boolean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	indexes</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		done</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			field</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;done&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_USRq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_dqUC" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_B2vR"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon__vxV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_IbEo" id="indexes-with-computation">Indexes with computation<a href="#indexes-with-computation" class="hash-link" aria-label="Direct link to Indexes with computation" title="Direct link to Indexes with computation">​</a></h3>
<p>You can process your document&#x27;s data into an index value. This is an important and powerful concept which is the heart of making queries in Verdant in the same way that SQL is for relational databases.</p>
<p>To make a computed index, supply a <code>type</code> and <code>compute</code> property.</p>
<div class="language-ts codeBlockContainer_RtSA theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_TVFK"><pre tabindex="0" class="prism-code language-ts codeBlock_Y3bB thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_hR3p"><span class="token-line" style="color:#393A34"><span class="token plain">indexes</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	likesWithMaxOf50</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;number&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token function-variable function" style="color:#d73a49">compute</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> Math</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">min</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">likes</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">50</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_USRq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_dqUC" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_B2vR"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon__vxV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This field won&#x27;t be present on a todo item in your code, but it will be queryable.</p>
<p>You can use any synchronous logic you want to create synthetic indexes. But you should keep them deterministic! A non-deterministic index value will change whether a document matches a query every time you write to it.</p>
<h4 class="anchor anchorWithStickyNavbar_IbEo" id="valid-types-of-indexes">Valid types of indexes<a href="#valid-types-of-indexes" class="hash-link" aria-label="Direct link to Valid types of indexes" title="Direct link to Valid types of indexes">​</a></h4>
<p>Indexes have different acceptable types from fields. Here&#x27;s all the types you can use:</p>
<ul>
<li><code>string</code></li>
<li><code>number</code></li>
<li><code>boolean</code></li>
<li><code>string[]</code></li>
<li><code>number[]</code></li>
<li><code>boolean[]</code></li>
</ul>
<p>Basically, any primitive value or list of primitive values.</p>
<h4 class="anchor anchorWithStickyNavbar_IbEo" id="using-synthetic-indexes-for-text-search">Using synthetic indexes for text search<a href="#using-synthetic-indexes-for-text-search" class="hash-link" aria-label="Direct link to Using synthetic indexes for text search" title="Direct link to Using synthetic indexes for text search">​</a></h4>
<p>You can do some basic text search using a simple synthetic index. The easiest version looks like this:</p>
<div class="language-ts codeBlockContainer_RtSA theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_TVFK"><pre tabindex="0" class="prism-code language-ts codeBlock_Y3bB thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_hR3p"><span class="token-line" style="color:#393A34"><span class="token plain">titleMatch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;string[]&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token function-variable function" style="color:#d73a49">compute</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">post</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> post</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">title</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex char-set class-name" style="color:#36acaa">\s</span><span class="token regex regex-source language-regex quantifier number" style="color:#36acaa">+</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_USRq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_dqUC" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_B2vR"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon__vxV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This splits the text into words which make up the index value. When you have an array-type index value, the document will be returned if any of the generated values matches the filter.</p>
<p>So you can then search for text that includes a given word stem like so:</p>
<div class="language-ts codeBlockContainer_RtSA theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_TVFK"><pre tabindex="0" class="prism-code language-ts codeBlock_Y3bB thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_hR3p"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// will match posts with titles like: &quot;fool&#x27;s gold&quot;, &quot;good food&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">client</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">posts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">findAll</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	index</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		where</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;titleMatch&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		startsWith</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;foo&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_USRq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_dqUC" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_B2vR"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon__vxV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>To reduce the index size, you can use a library like <code>stopword</code> to remove common words before indexing.</p>
<p>For fuzzier text matching, you might be able to create a sort of flat trie structure with some alternate stems for various words. I haven&#x27;t tried anything that advanced, but a the end of the day all you need to do is produce an array of strings which partially match the filter text, so you can get creative!</p>
<h4 class="anchor anchorWithStickyNavbar_IbEo" id="compound-indexes">Compound indexes<a href="#compound-indexes" class="hash-link" aria-label="Direct link to Compound indexes" title="Direct link to Compound indexes">​</a></h4>
<p>Compound indexes are a special case of synthetic index with more structure and query options. You can use them to query on two or more fields at once. For example, if you had a compound index</p>
<div class="language-ts codeBlockContainer_RtSA theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_TVFK"><pre tabindex="0" class="prism-code language-ts codeBlock_Y3bB thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_hR3p"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> items </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">collection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;item&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	primaryKey</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;id&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	fields</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fields</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">id</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		done</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fields</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">boolean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		details</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> schema</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">fields</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">string</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	compounds</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		done_details</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			</span><span class="token keyword" style="color:#00009f">of</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;done&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;details&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_USRq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_dqUC" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_B2vR"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon__vxV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>you can query for items which are done, in alphabetical order by their details. This may be faster than querying only by <code>indexableDone</code> and then sorting in-memory. You can also match values of multiple properties - you could query for incomplete items called &quot;wash dishes,&quot; for example.</p>
<p>Values in compound indexes will be coerced to strings automatically.</p>
<h2 class="anchor anchorWithStickyNavbar_IbEo" id="queries-and-mutations">Queries and mutations<a href="#queries-and-mutations" class="hash-link" aria-label="Direct link to Queries and mutations" title="Direct link to Queries and mutations">​</a></h2>
<p>You can use this client in your app now to store and query data. Use the root storage instance to create queries to find documents.</p>
<div class="language-ts codeBlockContainer_RtSA theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_TVFK"><pre tabindex="0" class="prism-code language-ts codeBlock_Y3bB thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_hR3p"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> firstDoneItemQuery </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> todos</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">todoItems</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">findOne</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	where</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;indexableDone&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	equals</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;true&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// subscribe to changes in the query</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> unsubscribe </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> firstDoneItemQuery</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">subscribe</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token builtin">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// await the first resolved value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> oneDoneItem </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">await</span><span class="token plain"> firstDoneItemQuery</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">resolved</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// modify a document</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">oneDoneItem</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;done&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_USRq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_dqUC" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_B2vR"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon__vxV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Queries return query objects immediately with empty data. Await <code>.resolved</code> to get the final results, or use <code>query.subscribe(callback)</code> to subscribe to changes over time.</p>
<p>Queries also do not immediately run upon creation. They are lazy-loaded, so an actual query operation will not happen until you interact with the query, either by calling <code>.execute()</code>, accessing <code>.resolved</code>, or by attaching a callback with <code>.subscribe</code>.</p>
<p>To get the instantaneous current result (even if the query has not completed yet or is re-running), use <code>.current</code>. For single-entity queries, <code>.current</code> is <code>null</code> while the query is initializing. For list queries, it will be <code>[]</code>. You can access <code>.current</code> without triggering a lazy load of the query.</p>
<p>Queries also have a <code>.status</code> field to indicate their current status. <code>&#x27;initial&#x27;</code> means the query has not run yet. <code>&#x27;running&#x27;</code> means the query is fetching new results (but <code>.current</code> might still have valid data from a previous run). <code>&#x27;ready&#x27;</code> means the result set is up-to-date.</p>
<h3 class="anchor anchorWithStickyNavbar_IbEo" id="query-caching">Query caching<a href="#query-caching" class="hash-link" aria-label="Direct link to Query caching" title="Direct link to Query caching">​</a></h3>
<p>Queries have a caching behavior, determined by a cache key. Some queries automatically deduplicate: <code>get</code>, <code>findOne</code>, and <code>findAll</code>. Other queries don&#x27;t deduplicate and cache unless you provide a custom cache key.</p>
<p>All cached queries are temporarily stored by default, so if you query the same thing twice in a matter of seconds it should only run once. Subscribed queries stay cached and update live until you unsubscribe all subscribers.</p>
<p>You can use <code>client.queries.activeKeys</code> to see which query keys are cached at any moment.</p>
<h4 class="anchor anchorWithStickyNavbar_IbEo" id="cache-key-gotchas">Cache key gotchas<a href="#cache-key-gotchas" class="hash-link" aria-label="Direct link to Cache key gotchas" title="Direct link to Cache key gotchas">​</a></h4>
<p>Automatic cache key generation for queries which use an index filter is specific not just to the index name, but also the supplied value. In some programming environments, like Verdant&#x27;s React integration, this means that queries which dynamically alter the filtered value change their key and therefore their cached identity. For example, using a string from an input which the user is actively typing in to filter by an index value rapidly constructs and then discards queries, but these queries will still run to completion before being disposed.</p>
<p>To prevent this waste, you should supply a custom query key to queries you expect to rapidly alter their input values.</p>
<h4 class="anchor anchorWithStickyNavbar_IbEo" id="query-keep-alives">Query keep-alives<a href="#query-keep-alives" class="hash-link" aria-label="Direct link to Query keep-alives" title="Direct link to Query keep-alives">​</a></h4>
<p>Normally, if a query is not subscribed (by calling <code>.subscribe(&#x27;change&#x27;, ...)</code>) within 5 seconds, or 5 seconds after the last unsubscribe is called, it will be removed from the cache and garbage collected.</p>
<p>To prevent this, you can place a &#x27;keep alive&#x27; hold on a query by its key. Using custom keys for this is highly recommended.</p>
<p>Call <code>client.queries.keepAlive(key)</code> to place a hold on a query.</p>
<p>Call <code>client.queries.dropKeepAlive(key)</code> to remove a hold.</p>
<p>Use <code>client.queries.keepAlives</code> to see which queries have a hold placed. This is a <code>Set</code>.</p>
<h2 class="anchor anchorWithStickyNavbar_IbEo" id="querying-your-indexes">Querying your indexes<a href="#querying-your-indexes" class="hash-link" aria-label="Direct link to Querying your indexes" title="Direct link to Querying your indexes">​</a></h2>
<p>Verdant generates typings for filters on the indexes you create on your collections. Explore the generated TypeScript definitions to see what your query options are.</p>
<p>Indexed fields and compound indexes generate exact and range query filters. Compound indexes generate match filters.</p>
<div class="language-ts codeBlockContainer_RtSA theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_TVFK"><pre tabindex="0" class="prism-code language-ts codeBlock_Y3bB thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_hR3p"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// field / synthetic filters:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">TodoIdMatchFilter</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	where</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;id&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	equals</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	order</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;asc&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;desc&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">TodoIdRangeFilter</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	where</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;id&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	gte</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	gt</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	lte</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	lt</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	order</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;asc&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;desc&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// compound filters:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">interface</span><span class="token plain"> </span><span class="token class-name">TodoTagsSortedByDoneCompoundFilter</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	where</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;tagsSortedByDone&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	match</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		tags</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		done</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">boolean</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	order</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;asc&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;desc&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup_USRq"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_dqUC" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_B2vR"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon__vxV"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>When using a compound filter, you must match values in the order they were specified in your <code>of</code> list. For example, if your <code>of</code> list was <code>[&#x27;tags&#x27;, &#x27;done&#x27;]</code>, you may not match <code>done</code> without also matching <code>tags</code> - but you can match <code>tags</code> alone, in which case items will be ordered by <code>done</code>.</p>
<p>TODO: more docs on how index queries work.</p>
<h2 class="anchor anchorWithStickyNavbar_IbEo" id="paginated-queries">Paginated queries<a href="#paginated-queries" class="hash-link" aria-label="Direct link to Paginated queries" title="Direct link to Paginated queries">​</a></h2>
<p>In addition to simple <code>get</code>, <code>findOne</code>, and <code>findAll</code> queries, which return the entire relevant dataset, you can make paginated queries to begin displaying large sets of data earlier and reduce memory footprint.</p>
<p>Keep in mind, though, that this database is local! Optimizations may not be necessary as early as they are on a server. Then again, IndexedDB is kind of slow, so just see how it feels.</p>
<p>There are two kinds of paginated queries: <code>findAllInfinite</code> and <code>findPage</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_IbEo" id="infinite-queries">Infinite queries<a href="#infinite-queries" class="hash-link" aria-label="Direct link to Infinite queries" title="Direct link to Infinite queries">​</a></h3>
<p>Calling <code>findAllInfinite</code> will create an infinite-loader style query, where the result set gradually gets larger as you load new pages until you reach the end. This kind of query is ideal for quickly loading a subset of data to display, then gradually adding more if the user continues browsing or scrolling. It <em>can</em> reduce memory usage in practice, but in principle you should assume the user will scroll to the end and design your app to handle this.</p>
<p>The query returned from <code>findAllInfinite</code> has two special properties for usage:</p>
<ul>
<li><code>hasMore</code>: a boolean which is <code>true</code> if there are more pages to load</li>
<li><code>loadMore</code>: a function to call which expands the result set. Returns a promise for the load. The changes to the result set will also call any subscribed callback on the query.</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_IbEo" id="page-queries">Page queries<a href="#page-queries" class="hash-link" aria-label="Direct link to Page queries" title="Direct link to Page queries">​</a></h4>
<p>Calling <code>findPage</code> will create a paginated-style query, where each new loaded page of results replaces the previous page as the result set. This should keep memory footprint stable as you display different slices of a large result set.</p>
<p>The query returned from <code>findPage</code> has several special properties:</p>
<ul>
<li><code>hasPreviousPage</code>: a boolean which is <code>true</code> if you can request the previous page (i.e. page &gt; 0)</li>
<li><code>hasNextPage</code>: a boolean which is <code>true</code> if you can request the next page. Will be false if there are no more results for the query.</li>
<li><code>page</code>: the current page number. 0-based.</li>
<li><code>pageSize</code>: how many results are fetched in each page. Cannot be changed.</li>
<li><code>nextPage</code>: a function which can be called to move to the next page of results. Returns a promise for the operation. The page change will also call any callbacks used in <code>subscribe</code>. The result set (<code>current</code>) will be replaced with the new page of results.</li>
<li><code>previousPage</code>: a function which can be called to move to the previous page of results. Returns a promise for the operation. The page change will also call any callbacks used in <code>subscribe</code>. The result set (<code>current</code>) will be replaced with the new page of results.</li>
<li><code>setPage</code>: a function, like the other page change methods, but allows you to pass a specific page number (0-based). Note that passing a page number which is beyond the limit of the results set will end up with an empty array of results for the query.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_IbEo" id="manual-cache-keys">Manual cache keys<a href="#manual-cache-keys" class="hash-link" aria-label="Direct link to Manual cache keys" title="Direct link to Manual cache keys">​</a></h2>
<p>You can provide a custom cache key to <code>findPage</code>, <code>findAllInfinite</code>, <code>findOne</code> and <code>findAll</code> queries. Only the first two are recommended, though.</p>
<p>Providing a custom key to queries allows them to be cached independently of other queries with the same parameters. Without providing a custom cache key for repeated queries, the loaded state of each query will be the same in each place it&#x27;s used. Usually this is a good thing, but not always for paginated queries. For example, if you go to page 2 on one screen of your app and navigate somewhere else where the same query and key are used, it will also now be on page 2. Same with the number of results loaded in an infinite query. To create two queries of the same parameters which don&#x27;t share state like this, you need to provide a different cache key to one or both so they&#x27;re not treated the same by the cache.</p>
<h2 class="anchor anchorWithStickyNavbar_IbEo" id="caveat-deleted-entities">Caveat: deleted entities<a href="#caveat-deleted-entities" class="hash-link" aria-label="Direct link to Caveat: deleted entities" title="Direct link to Caveat: deleted entities">​</a></h2>
<p>Deleting an entity does not currently refresh a query beyond removing that entity from the result set. This means that after deleting something from a paginated query, the page which contained that entity will be smaller by 1 than other pages until the query is next refreshed. This behavior may change in the future.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/local-storage/migrations"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Migrations</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/local-storage/entities"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Documents &amp; Entities</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_f7ev thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#indexes" class="table-of-contents__link toc-highlight">Indexes</a><ul><li><a href="#indexes-with-computation" class="table-of-contents__link toc-highlight">Indexes with computation</a></li></ul></li><li><a href="#queries-and-mutations" class="table-of-contents__link toc-highlight">Queries and mutations</a><ul><li><a href="#query-caching" class="table-of-contents__link toc-highlight">Query caching</a></li></ul></li><li><a href="#querying-your-indexes" class="table-of-contents__link toc-highlight">Querying your indexes</a></li><li><a href="#paginated-queries" class="table-of-contents__link toc-highlight">Paginated queries</a><ul><li><a href="#infinite-queries" class="table-of-contents__link toc-highlight">Infinite queries</a></li></ul></li><li><a href="#manual-cache-keys" class="table-of-contents__link toc-highlight">Manual cache keys</a></li><li><a href="#caveat-deleted-entities" class="table-of-contents__link toc-highlight">Caveat: deleted entities</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/a-type/verdant" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_yf4q"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gfor.rest" target="_blank" rel="noopener noreferrer" class="footer__link-item">Who made this?</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Grant Forrest. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>