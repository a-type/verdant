<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-local-storage/schema">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Why have a schema? | Verdant</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://verdant.dev/docs/local-storage/schema"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:title" content="verdant"><meta data-rh="true" name="twitter:description" content="a framework for small, sustainable, human apps"><meta data-rh="true" name="twitter:image" content="https://verdant.dev/opengraph.png"><meta data-rh="true" name="og:image" content="https://verdant.dev/opengraph.png"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Why have a schema? | Verdant"><meta data-rh="true" name="description" content="Verdant requires all data be defined in a schema. That may seem cumbersome, but knowing what data looks like is essential to changing the shape of that data over time as your app evolves. Data lives on user devices, not your servers, so getting migrations right is very important&amp;mdash;data loss or corruption can be unrecoverable, and no backups exist."><meta data-rh="true" property="og:description" content="Verdant requires all data be defined in a schema. That may seem cumbersome, but knowing what data looks like is essential to changing the shape of that data over time as your app evolves. Data lives on user devices, not your servers, so getting migrations right is very important&amp;mdash;data loss or corruption can be unrecoverable, and no backups exist."><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://verdant.dev/docs/local-storage/schema"><link data-rh="true" rel="alternate" href="https://verdant.dev/docs/local-storage/schema" hreflang="en"><link data-rh="true" rel="alternate" href="https://verdant.dev/docs/local-storage/schema" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Verdant RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Verdant Atom Feed"><link rel="stylesheet" href="/assets/css/styles.765750a5.css">
<link rel="preload" href="/assets/js/runtime~main.b7d3f9f4.js" as="script">
<link rel="preload" href="/assets/js/main.a461e675.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_Wy77">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/favicon-32x32.png" alt="Verdant logo" class="themedImage_YoYt themedImage--light_io7T"><img src="/favicon-32x32.png" alt="Verdant logo" class="themedImage_YoYt themedImage--dark_x6Fh"></div><b class="navbar__title text--truncate">Verdant</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/a-type/verdant" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pvEX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_aaQS colorModeToggle_zzH1"><button class="clean-btn toggleButton_aMEy toggleButtonDisabled_GHHW" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_ywfS"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_JtjS"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox__mRI"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_OiwQ docsWrapper_JQfB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_o_vs" type="button"></button><div class="docPage_i_cg"><aside class="theme-doc-sidebar-container docSidebarContainer_W3CP"><div class="sidebar_zkUS"><nav class="menu thin-scrollbar menu_tdVB"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Intro to Verdant</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/manifesto">The Verdant manifesto on sustainable software</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/storing--querying">Storing &amp; Querying</a><button aria-label="Toggle the collapsible sidebar category &#x27;Storing &amp; Querying&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/local-storage/schema">Why have a schema?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/generate-client">Generating the client code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/migrations">Migrations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/querying">Indexes &amp; Querying</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/entities">Documents &amp; Entities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/undo">Undo, Redo, and Batching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/files">File storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/export">Exporting and importing data</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/sync">Sync</a><button aria-label="Toggle the collapsible sidebar category &#x27;Sync&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/react">React</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cli">CLI</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/how-it-works">How it works</a><button aria-label="Toggle the collapsible sidebar category &#x27;How it works&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/react-router">React Router</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/comparisons">Comparisons to other local-first tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/efficiency">Efficiency &amp; Performance</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/tutorials">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></aside><main class="docMainContainer_n2Kr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_qTeG"><div class="docItemContainer_NWgK"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_SdBV" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_GEeg"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/storing--querying"><span itemprop="name">Storing &amp; Querying</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Why have a schema?</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_FZzE theme-doc-toc-mobile tocMobile_Waqm"><button type="button" class="clean-btn tocCollapsibleButton_XliJ">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Why have a schema?</h1><p>Verdant requires all data be defined in a schema. That may seem cumbersome, but knowing what data looks like is essential to changing the shape of that data over time as your app evolves. Data lives on user devices, not your servers, so getting migrations right is very important<!-- -->—<!-- -->data loss or corruption can be unrecoverable, and no backups exist.</p><p>Take the time to think about how you model your data and define it in your schema. Mistakes in local-first apps are costly!</p><h1>Creating a schema</h1><p>The first step client-side is to define a schema of what kind of documents you are working with. A schema looks like this:</p><div class="language-ts codeBlockContainer_dQAR theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_rCyi"><pre tabindex="0" class="prism-code language-ts codeBlock_s4AU thin-scrollbar"><code class="codeBlockLines_aFFG"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> collection</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> schema </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@verdant-web/store&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> todoItems </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">collection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;todoItem&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// your primary key must be a field in your collection,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// and you must not rewrite it after creating a document.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    primaryKey</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;id&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    fields</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;string&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            indexed</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            unique</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        details</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;string&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            indexed</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            unique</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        done</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            type</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;boolean&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    indexes</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    compounds</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">schema</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    version</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    collections</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        todoItems</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> todoItems</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_JvVh"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_M1vE" aria-hidden="true"><svg class="copyButtonIcon_HObv" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_ZZmC" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This schema creates 1 document type, <code>todoItem</code>, and defines some fields. It also creates the initial default migration to set up this schema in IndexedDB.</p><p>The TypeScript types for <code>collection</code> should enforce proper schema shape, but the docs below explain what each part means.</p><blockquote><p>Note: for now I recommend you define collections at the top level, like shown above, or even split them into their own modules. There&#x27;s a problem with TypeScript typings if you define collections inline inside <code>schema()</code>.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_SsL4" id="requirements-for-a-schema">Requirements for a schema<a class="hash-link" href="#requirements-for-a-schema" title="Direct link to heading">​</a></h2><p>Each schema needs a <code>version</code>. Whenever a change is made to the schema, the version must be incremented. Otherwise, Verdant will crash with an error.</p><p>Schemas also have a map of <code>collections</code>. These define what kinds of documents are stored in your database.</p><p>Your schema can be multiple files, but the entry file (which you provide to the CLI) must have a default export which is a <code>schema()</code>.</p><h2 class="anchor anchorWithStickyNavbar_SsL4" id="requirements-for-a-collection">Requirements for a collection<a class="hash-link" href="#requirements-for-a-collection" title="Direct link to heading">​</a></h2><p>Each collection needs the following:</p><ul><li><code>name</code>: a singular name for the collection.</li><li><code>primaryKey</code>: specify which field name acts as the primary document key. Must be a string or number field.</li><li><code>fields</code>: a map of root fields on the document. See below.</li></ul><p>Additionally, you can add complex indexes for querying the collection:</p><ul><li><code>indexes</code>: freeform indexes which process the document into one indexed value (or an array of values) whenever it changes.</li><li><code>compounds</code>: multi-value indexes which let you query multiple field values at once. Advanced feature.</li></ul><p>See more on indexes <a href="/docs/local-storage/querying">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_SsL4" id="types-of-fields">Types of fields<a class="hash-link" href="#types-of-fields" title="Direct link to heading">​</a></h2><p>Here&#x27;s a list of field <code>type</code>s you can use in a collection, and their related options.</p><h3 class="anchor anchorWithStickyNavbar_SsL4" id="string"><code>&#x27;string&#x27;</code><a class="hash-link" href="#string" title="Direct link to heading">​</a></h3><p>Defines a string field, as you&#x27;d expect.</p><p>Other options:</p><ul><li><code>nullable: true</code>: allows <code>null</code> as a valid value for this field.</li><li><code>default: string | (() =&gt; string)</code>: define a default value, or a function that returns a default value at create time.</li></ul><h3 class="anchor anchorWithStickyNavbar_SsL4" id="number"><code>&#x27;number&#x27;</code><a class="hash-link" href="#number" title="Direct link to heading">​</a></h3><p>Defines a number field, as you&#x27;d expect.</p><p>Other options:</p><ul><li><code>nullable: true</code>: allows <code>null</code> as a valid value for this field.</li><li><code>default: number | (() =&gt; number)</code>: define a default value, or a function that returns a default value at create time.</li></ul><h3 class="anchor anchorWithStickyNavbar_SsL4" id="boolean"><code>&#x27;boolean&#x27;</code><a class="hash-link" href="#boolean" title="Direct link to heading">​</a></h3><p>Defines a boolean field, as you&#x27;d expect.</p><p>Other options:</p><ul><li><code>nullable: true</code>: allows <code>null</code> as a valid value for this field.</li><li><code>default: boolean | (() =&gt; boolean)</code>: define a default value, or a function that returns a default value at create time.</li></ul><h3 class="anchor anchorWithStickyNavbar_SsL4" id="array"><code>&#x27;array&#x27;</code><a class="hash-link" href="#array" title="Direct link to heading">​</a></h3><p>Defines an array/list field. These can also act as sets. Arrays always default to empty.</p><p>Other options:</p><ul><li><code>items: FieldSchema</code>: a nested field schema definition which defines what each item in the array looks like.</li><li><code>nullable: true</code>: allows <code>null</code> as a valid value for this field.</li></ul><h3 class="anchor anchorWithStickyNavbar_SsL4" id="object"><code>&#x27;object&#x27;</code><a class="hash-link" href="#object" title="Direct link to heading">​</a></h3><p>Defines an object/record field. Objects always default to empty. Objects have statically-defined keys, each of which can have its own unique sub-schema. For maps where keys aren&#x27;t known until runtime, see <code>&#x27;map&#x27;</code>.</p><p>Other options:</p><ul><li><code>properties: { [Key: string]: FieldSchema }</code>: an object of key-&gt;value pairs, where values are nested field schema definitions which defines what kind of data exists on that key.</li><li><code>nullable: true</code>: allows <code>null</code> as a valid value for this field.</li></ul><h3 class="anchor anchorWithStickyNavbar_SsL4" id="map"><code>&#x27;map&#x27;</code><a class="hash-link" href="#map" title="Direct link to heading">​</a></h3><p>Defines a key-value map field, where keys are arbitrary and added at runtime, and values are given a known schema. Maps are never nullable and default empty.</p><p>Other options:</p><ul><li><code>values: FieldSchema</code>: defines the sub-schema for values in the map.</li></ul><h3 class="anchor anchorWithStickyNavbar_SsL4" id="file"><code>&#x27;file&#x27;</code><a class="hash-link" href="#file" title="Direct link to heading">​</a></h3><p>Defines a file field, which stores a file.</p><p>Other options:</p><ul><li><code>nullable: true</code>: allows <code>null</code> as a valid value for this field.</li><li><code>downloadRemote: true</code>: instructs the client to download and store file fields which are synced from other devices. By default, the client will instead load the file over the network. Using this is a tradeoff which enables offline file usage, but increases storage use.</li></ul><h3 class="anchor anchorWithStickyNavbar_SsL4" id="any"><code>&#x27;any&#x27;</code><a class="hash-link" href="#any" title="Direct link to heading">​</a></h3><p>Opts out of schema checking for a field. An <code>any</code> field can have nested data and can be used just like any other field, but no TypeScript types will be applied, and no runtime validation will occur (note: runtime validation doesn&#x27;t currently exist, anyway...)</p><p>Other options:</p><ul><li><code>default: any | (() =&gt; any)</code>: define a default value for this field</li></ul><h2 class="anchor anchorWithStickyNavbar_SsL4" id="indexing-fields">Indexing Fields<a class="hash-link" href="#indexing-fields" title="Direct link to heading">​</a></h2><p>In earlier versions of Verdant, you could index a field by adding <code>indexed: true</code> to it. To consolidate indexing, Verdant now requires all indexes to be specified in <code>indexes</code> or <code>compounds</code>. There&#x27;s a new index definition to easily index a single field (with typechecking): <code>{ field: &#x27;fieldName&#x27; }</code>, which you can use instead.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/category/storing--querying"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Storing &amp; Querying</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/local-storage/generate-client"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Generating the client code</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_a3z4 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#requirements-for-a-schema" class="table-of-contents__link toc-highlight">Requirements for a schema</a></li><li><a href="#requirements-for-a-collection" class="table-of-contents__link toc-highlight">Requirements for a collection</a></li><li><a href="#types-of-fields" class="table-of-contents__link toc-highlight">Types of fields</a><ul><li><a href="#string" class="table-of-contents__link toc-highlight"><code>&#39;string&#39;</code></a></li><li><a href="#number" class="table-of-contents__link toc-highlight"><code>&#39;number&#39;</code></a></li><li><a href="#boolean" class="table-of-contents__link toc-highlight"><code>&#39;boolean&#39;</code></a></li><li><a href="#array" class="table-of-contents__link toc-highlight"><code>&#39;array&#39;</code></a></li><li><a href="#object" class="table-of-contents__link toc-highlight"><code>&#39;object&#39;</code></a></li><li><a href="#map" class="table-of-contents__link toc-highlight"><code>&#39;map&#39;</code></a></li><li><a href="#file" class="table-of-contents__link toc-highlight"><code>&#39;file&#39;</code></a></li><li><a href="#any" class="table-of-contents__link toc-highlight"><code>&#39;any&#39;</code></a></li></ul></li><li><a href="#indexing-fields" class="table-of-contents__link toc-highlight">Indexing Fields</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/a-type/verdant" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_pvEX"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gfor.rest" target="_blank" rel="noopener noreferrer" class="footer__link-item">Who made this?</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Grant Forrest. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b7d3f9f4.js"></script>
<script src="/assets/js/main.a461e675.js"></script>
</body>
</html>