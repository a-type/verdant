<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-local-storage/entities" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Documents &amp; Entities | Verdant</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="https://verdant.dev/docs/local-storage/entities"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" name="twitter:title" content="verdant"><meta data-rh="true" name="twitter:description" content="a framework for small, sustainable, human apps"><meta data-rh="true" name="twitter:image" content="https://verdant.dev/opengraph.png"><meta data-rh="true" name="og:image" content="https://verdant.dev/opengraph.png"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Documents &amp; Entities | Verdant"><meta data-rh="true" name="description" content="Queries return Documents. A Document provides a .get method to retrieve properties, and a .set to set them - as well as other utility methods depending on its type. All root documents are Object Entities, which also provide .update. Since Documents can contain arbitrary sub-objects, you can retrieve lists off them, which comes as List Entities and provide some common list methods too."><meta data-rh="true" property="og:description" content="Queries return Documents. A Document provides a .get method to retrieve properties, and a .set to set them - as well as other utility methods depending on its type. All root documents are Object Entities, which also provide .update. Since Documents can contain arbitrary sub-objects, you can retrieve lists off them, which comes as List Entities and provide some common list methods too."><link data-rh="true" rel="icon" href="/favicon.ico"><link data-rh="true" rel="canonical" href="https://verdant.dev/docs/local-storage/entities"><link data-rh="true" rel="alternate" href="https://verdant.dev/docs/local-storage/entities" hreflang="en"><link data-rh="true" rel="alternate" href="https://verdant.dev/docs/local-storage/entities" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.848d850d.css">
<script src="/assets/js/runtime~main.35fc84e8.js" defer="defer"></script>
<script src="/assets/js/main.d5eb756f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/favicon-32x32.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_grwm" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/favicon-32x32.png" alt="Verdant logo" class="themedComponent_Mp3Q themedComponent--light_arQ9"><img src="/favicon-32x32.png" alt="Verdant logo" class="themedComponent_Mp3Q themedComponent--dark_edNh"></div><b class="navbar__title text--truncate">Verdant</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/intro">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/a-type/verdant" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_TkHd"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_HTtc colorModeToggle_Zc6n"><button class="clean-btn toggleButton_dCld toggleButtonDisabled_khVH" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_SvTK"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_rGd6"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_DQnC"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_R_Gv"><div class="docsWrapper_KMAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_N8Xm" type="button"></button><div class="docRoot_BQ69"><aside class="theme-doc-sidebar-container docSidebarContainer_eA7o"><div class="sidebarViewport_Ubog"><div class="sidebar_pztp"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_I60q"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">Intro to Verdant</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/manifesto">The Verdant manifesto on sustainable software</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/storing--querying">Storing &amp; Querying</a><button aria-label="Collapse sidebar category &#x27;Storing &amp; Querying&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/schema">Schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/generate-client">Generating the client code</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/migrations">Migrations</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/querying">Indexes &amp; Querying</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/local-storage/entities">Documents &amp; Entities</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/undo">Undo, Redo, and Batching</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/files">File storage</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/local-storage/export">Exporting and importing data</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/sync">Sync</a><button aria-label="Expand sidebar category &#x27;Sync&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/cli">CLI</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/react-bindings">React Bindings</a><button aria-label="Expand sidebar category &#x27;React Bindings&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/integrations">Integrations</a><button aria-label="Expand sidebar category &#x27;Integrations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/how-it-works">How it works</a><button aria-label="Expand sidebar category &#x27;How it works&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/comparisons">Comparisons to other local-first tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/efficiency">Efficiency &amp; Performance</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/tutorials">Tutorials</a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_WevJ"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Q61k"><div class="docItemContainer_j_9H"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Om02" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_nKsh"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/storing--querying"><span itemprop="name">Storing &amp; Querying</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Documents &amp; Entities</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_e9xA theme-doc-toc-mobile tocMobile_soHF"><button type="button" class="clean-btn tocCollapsibleButton_rkxb">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Documents &amp; Entities</h1></header>
<p>Queries return Documents. A Document provides a <code>.get</code> method to retrieve properties, and a <code>.set</code> to set them - as well as other utility methods depending on its type. All root documents are Object Entities, which also provide <code>.update</code>. Since Documents can contain arbitrary sub-objects, you can retrieve lists off them, which comes as List Entities and provide some common list methods too.</p>
<p>These methods are, of course, typed based on the shape of your schema definitions!</p>
<div class="language-ts codeBlockContainer_plQo theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_Dd25"><pre tabindex="0" class="prism-code language-ts codeBlock_xRQy thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_hMg_"><span class="token-line" style="color:#393A34"><span class="token plain">oneDoneItem</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">set</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;done&#x27;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">anItemWithAnArrayField</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;arrayField&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;foo&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup_VNA8"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_HEVz" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_O4HX"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_nU10"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>These will immediately update the in-memory document across all its subscribers (Entities are also cached by identity). The change will propagate to storage and sync asynchronously. When the change is stored, the document will update and drop the in-memory changes.</p>
<h2 class="anchor anchorWithStickyNavbar_AMdt" id="universal-entity-behavior">Universal Entity behavior<a href="#universal-entity-behavior" class="hash-link" aria-label="Direct link to Universal Entity behavior" title="Direct link to Universal Entity behavior">​</a></h2>
<p>All Entities provide some baseline functionality, including common metadata and the ability to subscribe to changes.</p>
<h3 class="anchor anchorWithStickyNavbar_AMdt" id="subscribing-to-changes">Subscribing to changes<a href="#subscribing-to-changes" class="hash-link" aria-label="Direct link to Subscribing to changes" title="Direct link to Subscribing to changes">​</a></h3>
<p>Entities are primarily used for reactive observation of data, so naturally you want to subscribe to changes!</p>
<p>The Entity API contains several methods of doing this with different levels of reactive granularity. Use the one that matches your needs best.</p>
<h4 class="anchor anchorWithStickyNavbar_AMdt" id="shallow-changes-subscribechange-callback">Shallow changes: <code>subscribe(&#x27;change&#x27;, callback)</code><a href="#shallow-changes-subscribechange-callback" class="hash-link" aria-label="Direct link to shallow-changes-subscribechange-callback" title="Direct link to shallow-changes-subscribechange-callback">​</a></h4>
<p>Calls <code>callback</code> when any <em>first-level</em> changes happen. Only monitors direct children of this entity. Returns an unsubscribe function.</p>
<p><code>callback</code> is called with <code>{ isLocal?: boolean }</code>, which will tell you if the change originated with the local replica or came from a remote source.</p>
<h4 class="anchor anchorWithStickyNavbar_AMdt" id="deep-changes-subscribechangedeep-callback">Deep changes: <code>subscribe(&#x27;changeDeep&#x27;, callback)</code><a href="#deep-changes-subscribechangedeep-callback" class="hash-link" aria-label="Direct link to deep-changes-subscribechangedeep-callback" title="Direct link to deep-changes-subscribechangedeep-callback">​</a></h4>
<p>Calls <code>callback</code> when any <em>deeply nested</em> changes happen. Monitors the current entity&#x27;s children and downward. Returns an unsubscribe function.</p>
<p><code>callback</code> is called with two parameters. The first is the target entity which was changed. The second is <code>{ isLocal?: boolean }</code>, which will tell you if the change originated with the local replica or came from a remote source.</p>
<p>It&#x27;s worth pointing out that the target entity passed as the first parameter doesn&#x27;t include much metadata that will help you identify <em>which</em> child object it is in relation to the entity subscribed to. You will have to utilize your own logic to compare this value with children you care about. Since designing this usage initially, I have not found this parameter to be actually that helpful 😅.</p>
<h4 class="anchor anchorWithStickyNavbar_AMdt" id="very-specific-changes-subscribetofieldfieldkey-change-callback">Very specific changes: <code>subscribeToField(fieldKey, &#x27;change&#x27;, callback)</code><a href="#very-specific-changes-subscribetofieldfieldkey-change-callback" class="hash-link" aria-label="Direct link to very-specific-changes-subscribetofieldfieldkey-change-callback" title="Direct link to very-specific-changes-subscribetofieldfieldkey-change-callback">​</a></h4>
<p>Calls <code>callback</code> whenever the referenced field of the entity changes. This is <em>shallow</em>, it will not monitor the field for deep changes. If you need that, <code>.get</code> the field and use <code>subscribe(&#x27;changeDeep&#x27;)</code> on it.</p>
<p>This is really more of a convenience for monitoring primitive field changes. <code>callback</code> will be called with two parameters: the current <code>value</code> of the field, and an object <code>{ isLocal?: boolean, previousValue: T }</code>, which will indicate if the change originated from the local replica or a peer, and what the prior value of the field was before the change.</p>
<h3 class="anchor anchorWithStickyNavbar_AMdt" id="entity-metadata">Entity metadata<a href="#entity-metadata" class="hash-link" aria-label="Direct link to Entity metadata" title="Direct link to Entity metadata">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_AMdt" id="uid">uid<a href="#uid" class="hash-link" aria-label="Direct link to uid" title="Direct link to uid">​</a></h4>
<p>Each entity (Documents and sub-objects) has a <code>.uid</code> property, which acts as a unique key for that entity in the system. <em>This is not the same as the primary key</em> and should be considered an opaque string. But you can use it for a React <code>key</code>, for example. You could also use it to compare Entity identities if you want, but because Entities are cached by identity already, you can just use <code>a === b</code>!</p>
<h4 class="anchor anchorWithStickyNavbar_AMdt" id="updatedat">updatedAt<a href="#updatedat" class="hash-link" aria-label="Direct link to updatedAt" title="Direct link to updatedAt">​</a></h4>
<p>Entities automatically provide an <code>.updatedAt</code> timestamp as a Unix Epoch value, too. This timestamp is computed from the CRDT metadata. It saves you the trouble of manually tracking this with a Document field, and it&#x27;s granular for each sub-object.</p>
<h4 class="anchor anchorWithStickyNavbar_AMdt" id="getsnapshot--getall">getSnapshot / getAll<a href="#getsnapshot--getall" class="hash-link" aria-label="Direct link to getSnapshot / getAll" title="Direct link to getSnapshot / getAll">​</a></h4>
<p>Entities provide two methods for reading all contained data. <code>getSnapshot()</code> returns a plain Javascript object with all contained data. This is useful for deep processing of nested values, serializing data for other systems, etc. Combined with <code>subscribe(&#x27;changeDeep&#x27;)</code>, you can sync plain object data to some other system, like a rich text editor or TLDraw canvas.</p>
<p><code>getAll</code>, on the other hand, destructures the first layer of the Entity, but all sub-objects remain reactive Entities. You can use this similar to an object destructure to quickly read many properties on the entity at once.</p>
<h4 class="anchor anchorWithStickyNavbar_AMdt" id="schemas">Schemas<a href="#schemas" class="hash-link" aria-label="Direct link to Schemas" title="Direct link to Schemas">​</a></h4>
<p>Entities expose information about their schema configuration, according to your Verdant store schema. You can reference <code>.schema</code> to read the schema of the entity in question, or use <code>getFieldSchema(key)</code> to get a child field&#x27;s schema. I&#x27;m not sure if there&#x27;s a use case for these, but they exist for internal use already, so they&#x27;re exposed if you want them.</p>
<h4 class="anchor anchorWithStickyNavbar_AMdt" id="authorization">Authorization<a href="#authorization" class="hash-link" aria-label="Direct link to Authorization" title="Direct link to Authorization">​</a></h4>
<p>Entities also include <code>.isAuthorized</code>, which tells you if the Entity has authorization rules applied to it. This is kind of low-fidelity, but the way Verdant currently works you can assume this is a private entity only the current user can see if the value is <code>true</code>. If Authorization features are developed further, this may morph into something with more information.</p>
<h2 class="anchor anchorWithStickyNavbar_AMdt" id="types-of-entities">Types of entities<a href="#types-of-entities" class="hash-link" aria-label="Direct link to Types of entities" title="Direct link to Types of entities">​</a></h2>
<p>Entities currently have two shapes: <code>Object</code> and <code>List</code>. <code>Object</code> covers the <code>object</code> and <code>map</code> field types and the root document. <code>List</code> covers <code>array</code> field types. <code>List</code> entities can also be used as rudimentary Sets.</p>
<p>Additionally, <code>file</code> type fields return <code>File</code> entities, a special type.</p>
<p>Each entity type exposes different fully-typed methods:</p>
<h3 class="anchor anchorWithStickyNavbar_AMdt" id="object-methods-and-properties">Object methods and properties<a href="#object-methods-and-properties" class="hash-link" aria-label="Direct link to Object methods and properties" title="Direct link to Object methods and properties">​</a></h3>
<ul>
<li><code>keys()</code>: Returns a list of all keys, like <code>Object.keys</code>.</li>
<li><code>entries()</code>: Returns <code>[key,value]</code> pairs, like <code>Object.entries</code>.</li>
<li><code>values()</code>: Returns a list of all values, like <code>Object.values</code>.</li>
<li><code>set(key, value)</code>: Sets a specific value on the entity.</li>
<li><code>delete(key)</code>: Deletes a value by key from the entity. Only works for <code>nullable</code> properties or on <code>map</code> type entities.</li>
<li><code>update(partial, { replaceSubObjects, merge })</code>: Applies a partial object value on the entity. Allows a few options for advanced usage:<!-- -->
<ul>
<li><code>replaceSubObjects</code>: Defaults <code>false</code>, use <code>true</code> to replace sub-objects by identity instead of trying to keep sub-object identity stable. Passing <code>true</code> means if any other peer is editing a sub-object, the changes made by this <code>update</code> will completely replace it, ignoring their changes. Use with care.</li>
<li><code>merge</code>: Defaults <code>true</code>, use <code>false</code> to cause omitted keys to erase their properties. Only works if omitted keys are optional in the schema, or on <code>map</code> type fields. Otherwise this will throw a runtime error.</li>
</ul>
</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_AMdt" id="list-methods-and-properties">List methods and properties<a href="#list-methods-and-properties" class="hash-link" aria-label="Direct link to List methods and properties" title="Direct link to List methods and properties">​</a></h3>
<ul>
<li><code>length</code>: Returns the length of the list, like <code>Array.length</code>.</li>
<li><code>push(item)</code>: Pushes an item onto the list. Push conflicts are resolved by intent; i.e. if two pushes are concurrent both items will be added in chronological order to the end of the list.</li>
<li><code>insert(index, item)</code>: Inserts an item at index, moving later items down. Insert conflicts are resolved by intent; i.e. if an insert is concurrent to some other change in the list, Verdant will still try to place the item at the index specified.</li>
<li><code>move(from, to)</code>: Moves an item from one index to another, moving other items to make room for it at the destination. Move conflicts are resolved by intent; multiple moves will be applied in chronological order using whatever items are at the specified <code>from</code> index at time of resolution. For a more stable move when the <code>from</code> item&#x27;s identity is important, use <code>moveItem</code>.</li>
<li><code>moveItem(item, to)</code>: Moves the first instance of one particular item (by identity) to an index. <strong>If the items in this list are objects, you must pass a reference to an object retrieved from this entity, like one from <code>get()</code></strong>. Item move conflicts are resolved by intent, meaning even if the target item has moved from its original position during concurrent edits, the item will still be found and moved to the desired position. If the item is not found, nothing happens, and no error is thrown.</li>
<li><code>add(item)</code>: A Set add method. Only pushes the item to the end of the list if it does not already exist in the list (by identity). Add conflicts are resolved by intent, meaning if two adds are concurrent, the add will not insert the item twice.</li>
<li><code>removeAll(item)</code>: A Set remove method. Removes all instances of an item (by identity) from the list.</li>
<li><code>has(item)</code>: A Set has method. Returns true if an item exists in the list (by identity).</li>
<li><code>removeFirst(item)</code>: Removes only the first instance of an item (by identity). Remove first conflicts are resolved by intent, meaning if changes are resolved between peers and a new instance of the item is found earlier in the list than when this method was called on a client, that earlier item will be removed. This only really applies to primitive lists, since by definition a list of objects can&#x27;t hold two objects of the same identity.</li>
<li><code>removeLast(item)</code>: Like <code>removeFirst</code>, but from the opposite end.</li>
<li><code>map(callback)</code>: Does not modify the list. Lets you map over the items in the list and transform them. Returns a new JS <code>Array</code> with the mapped items (not a new List entity). Similar to <code>Array.map</code>.</li>
<li><code>filter(callback)</code>: Does not modify the list. Lets you filter items to a subset. Returns a new JS <code>Array</code> with the filtered items (not a new List entity). Similar to <code>Array.filter</code>.</li>
<li><code>delete(index)</code>: Deletes an item from the list by index. The item at the index is removed, and other items shift to &#x27;fill the space.&#x27; Similar to <code>Array.splice(index, 1)</code>.</li>
<li><code>forEach(callback)</code>: Invokes the callback with each item in the list. Similar to <code>Array.forEach</code>.</li>
<li><code>some(callback)</code>: Returns <code>true</code> if any item in the list passes the predicate (the callback returns <code>true</code>). Similar to <code>Array.some</code>.</li>
<li><code>every(callback)</code>: Returns <code>true</code> if every item in the list passes the predicate (the callback returns <code>true</code>). Similar to <code>Array.every</code>.</li>
<li><code>find(callback)</code>: Returns the first item in the list that passes the predicate (the callback returns <code>true</code>). Similar to <code>Array.find</code>.</li>
<li><code>includes(item)</code>: Alias of <code>has</code>, to align with <code>Array.includes</code>.</li>
</ul>
<p>Additionally, List entities implement <code>Iterable</code>, so you can use them in <code>for...of</code> loops.</p>
<h3 class="anchor anchorWithStickyNavbar_AMdt" id="file-methods-and-properties">File methods and properties<a href="#file-methods-and-properties" class="hash-link" aria-label="Direct link to File methods and properties" title="Direct link to File methods and properties">​</a></h3>
<ul>
<li><code>url</code>: Either a <code>string</code> URL for the file, or <code>null</code> if the file is not available for any reason (loading or error)</li>
<li><code>name</code>: The filename, as recorded when it was created. May be <code>null</code>.</li>
<li><code>type</code>: The file mimetype as recorded when it was created. May be <code>null</code>.</li>
<li><code>loading</code>: True if the file is still being fetched.</li>
<li><code>failed</code>: True if the file failed to load.</li>
<li><code>isUploaded</code>: True if the file has been uploaded to a sync server.</li>
<li><code>isFile</code>: always true.</li>
<li><code>getSnapshot()</code>: Returns a plain object with metadata about the current state of the file. Includes <code>url</code>, <code>name</code>, <code>remote</code> (is the file uploaded to the server?), <code>type</code>, and <code>file</code> (the literal File blob, if available).</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_AMdt" id="primary-key">Primary key<a href="#primary-key" class="hash-link" aria-label="Direct link to Primary key" title="Direct link to Primary key">​</a></h2>
<p>Every document has a primary key, which identifies it throughout the Verdant system. This primary key cannot be changed. Right now the types on documents will accept the primary key in a <code>.set</code> or <code>.update</code>, but will throw an error at runtime if it&#x27;s used. In the future hopefully I&#x27;ll update the types to make this constraint easier to catch while coding.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/local-storage/querying"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Indexes &amp; Querying</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/local-storage/undo"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Undo, Redo, and Batching</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_GnxE thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#universal-entity-behavior" class="table-of-contents__link toc-highlight">Universal Entity behavior</a><ul><li><a href="#subscribing-to-changes" class="table-of-contents__link toc-highlight">Subscribing to changes</a></li><li><a href="#entity-metadata" class="table-of-contents__link toc-highlight">Entity metadata</a></li></ul></li><li><a href="#types-of-entities" class="table-of-contents__link toc-highlight">Types of entities</a><ul><li><a href="#object-methods-and-properties" class="table-of-contents__link toc-highlight">Object methods and properties</a></li><li><a href="#list-methods-and-properties" class="table-of-contents__link toc-highlight">List methods and properties</a></li><li><a href="#file-methods-and-properties" class="table-of-contents__link toc-highlight">File methods and properties</a></li></ul></li><li><a href="#primary-key" class="table-of-contents__link toc-highlight">Primary key</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Docs</a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/a-type/verdant" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_TkHd"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://gfor.rest" target="_blank" rel="noopener noreferrer" class="footer__link-item">Who made this?</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Grant Forrest. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>